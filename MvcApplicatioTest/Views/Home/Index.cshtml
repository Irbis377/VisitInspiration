@model List<MvcApplicatioTest.Models.PhotoFlickr>
@{
    ViewBag.Title = "TEST";
}

<meta name="author" content="irbis377" />

<link href="@Url.Content("~/Content/style.css")" rel="stylesheet" type="text/css" />

<h2 style="color: #000000; text-align:center;">Find your insparition and visit it!</h2>

<div id="photoListDiv">
    @{Html.RenderAction("ListPhotos", "Home", new { Model = Model });}
</div>

@* show gif for loading in the end of page *@
<div id="loadingDiv" style="text-align: center; display: none; margin-bottom: 20px;">
    <img alt="Loading" src="@Url.Content("~/Content/Images/ajax-loader.gif")" />
</div>

<script src="@Url.Content("~/Scripts/jquery-1.8.2.min.js")" type="text/javascript"></script>

<script type="text/javascript">
    var BlockNumber = 2;  //Infinate Scroll starts from second block
    var inProgress = false;

    $(window).scroll(function () {
        if ($(window).scrollTop() == $(document).height() - $(window).height() && !inProgress) {

            inProgress = true;
            $("#loadingDiv").show();

            $.post("@Url.Action("InfinateScroll", "Home")", { "BlockNumber": BlockNumber },
                    function (data) {

                        BlockNumber = BlockNumber + 1;
                        $("#photoListDiv").append(data.HTMLString);
                        $("#loadingDiv").hide();
                        inProgress = false;
                    });
        }
    });
</script>
